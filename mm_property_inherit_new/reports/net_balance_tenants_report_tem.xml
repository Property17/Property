<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="tem_net_balance_ten_id">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <t class="page">
                    <div>
                            <div class="panel panel-primary">
                                <div>
                                    <table>

                                        <tr>
                                        <div style="text-align:center">

                                            <h2>
                                                <strong>Net Balance Tenants Report</strong>
                                            </h2>
                                            </div>
                                        </tr>
                                        <tr >
                                        <div style="text-align:center">

                                                <h6>
                                                    <strong>Print Date:</strong>
                                                <t t-esc="time.strftime('%Y-%m-%d %H:%M:%S')" />
                                                </h6>
                                        </div>

                                        </tr>
                                        <tr>
                                            <div style="text-align:center">

                                                <h6>

                                                    <t t-if="form.get('from_date')">
                                                    <strong>Date</strong>

                                                        <t t-esc="form['from_date']" />
                                                    </t>
                                                    <t t-if="form.get('to_date')">
                                                    <strong>To</strong>

                                                        <t t-esc="form['to_date']" />
                                                    </t>
                                                </h6>
                                            </div>
                                        </tr>

                                        <tr>
                                        <div style="text-align:left">

                                            <h6>

                                            <t t-if="form.get('company_id')">
                                                <strong>Company</strong>
                                                <t t-esc="form['company_id']" />
                                            </t>
                                            </h6>

                                        </div>

                                        </tr>
                                        <tr>
                                        <div style="text-align:left">

                                        <h6>
                                            <t t-if="form.get('property_manager_id')">
                                                <strong>Property Manager</strong>
                                                    <t t-esc="form['property_manager_id']" />
                                            </t>
                                            </h6>

                                        </div>
                                        </tr>

                                        <tr>
                                        <div style="text-align:left">

                                        <h6>

                                            <t t-if="form.get('parent_property_id')">
                                                <strong>Parent Property</strong>
                                                    <t t-esc="form['parent_property_id']" />
                                            </t>
                                            </h6>

                                        </div>
                                        </tr>


                                    </table>
                                </div>
                            </div>
                    </div>
                    <table class="table table-condensed table-bordered"
                        style="width:100%; table-layout: fixed;">
                        <thead>
                            <!-- <tr style="font-size:18px;text-align: center;">
                                <td style="width:5%;">
                                    <b>
                                        NO
                                    </b>
                                </td>
                                <td style="width:10%;">
                                    <b>
                                        Properties
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Tenant
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Phone
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Tenancy
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Tenancy Rent
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        State
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Close Date
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Legal
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Months due
                                    </b>
                                </td>
                                <td style="width:50%;">
                                    <b>
                                        Months
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Initial Balance
                                    </b>
                                </td>
                               
                                <td>
                                    <b>
                                        Debit
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Credit
                                    </b>
                                </td>
                                <td>
                                    <b>
                                        Total Balance
                                    </b>
                                </td>
                            
                            </tr> -->

                            <tr style="font-size:18px;text-align: center;">
                                <td style="width: 5%;">
                                    <b>NO</b>
                                </td>
                                <td style="width: 10%;">
                                    <b>Properties</b>
                                </td>
                                <td style="width: 10%;">
                                    <b>Tenant</b>
                                </td>
                                <td style="width: 9%;">
                                    <b>Phone</b>
                                </td>
                                <td style="width: 8%;">
                                    <b>Tenancy</b>
                                </td>
                                <td style="width: 8%;">
                                    <b>Tenancy Rent</b>
                                </td>
                                <td style="width: 6%;">
                                    <b>State</b>
                                </td>
                                <td style="width: 8%;">
                                    <b>Close Date</b>
                                </td>
                                <td style="width: 7%;">
                                    <b>Legal</b>
                                </td>
                                <td style="width: 7%;">
                                    <b>Months due</b>
                                </td>
                                <td style="width: 15%; white-space: nowrap;">
                                    <b>Months</b>
                                </td>
                                <td style="width: 8%;">
                                    <b>Initial Balance</b>
                                </td>
                                <td style="width: 6%;">
                                    <b>Debit</b>
                                </td>
                                <td style="width: 6%;">
                                    <b>Credit</b>
                                </td>
                                <td style="width: 8%;">
                                    <b>Total Balance</b>
                                </td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="parent_dict2" t-as="parent_id">
                                <t t-set="count" t-value="0" />
                                <t t-set="initial_total" t-value="0" />
                                <t t-set="balance_total" t-value="0" />
                                <t t-set="total_balance_total" t-value="0" />
                                <t t-set="balance_accurate" t-value="0" />
                                <t t-set="balance_advanced" t-value="0" />
                                <tr>
                                <td class="text-center" style="white-space: nowrap; text-align: center;" colspan="12">
                                        <strong>
                                            <t t-esc="parent_id" />
                                        </strong>
                                    </td>
                                </tr>
                            <t t-set="parent_id" t-value="parent_id" />
                            <t t-foreach="docs" t-as="loc">
                                    <!-- <t t-if="parent_id == loc['parent_id']"> -->
                                    <!-- <t t-if="parent_id == loc['parent_id'] and loc['total_balance'] != 0 and loc['credit'] != 0 and loc['debit'] != 0"> -->
                                    <t
                                            t-if="parent_id == loc['parent_id'] and loc['total_balance'] != 0">

                                        <tr>
                                    <td>
                                        <t t-set="count" t-value="count + 1" />
                                        <t t-esc="count" />
                                        <t t-set="initial_total"
                                            t-value="initial_total + loc['initial_balance']" />
                                        <t t-set="balance_total"
                                            t-value="balance_total + loc['balance']" />
                                        <t t-set="total_balance_total"
                                            t-value="total_balance_total + loc['total_balance']" />

                                        <t t-if="loc['total_balance'] &gt; 0">
                                            <t t-set="balance_accurate"
                                                        t-value="balance_accurate + loc['total_balance']" />
                                        </t>
                                        <t t-if="loc['total_balance'] &lt; 0">

                                        <t t-set="balance_advanced"
                                                    t-value="balance_advanced + loc['total_balance']" />
                                        </t>

                                    </td>
                                    <td class="text-center">
                                        <n>
                                          <span t-esc="loc['properties']" />
                                        </n>
                                    </td>

                                    <td class="text-center">
                                        <n>
                                                    <span t-esc="loc['tenant_id']" />
                                        </n>
                                    </td>
                                    <td class="text-center">
                                        <n>
                                            <span t-esc="loc['phone']" />
                                        </n>
                                    </td>
                                    <td class="text-center">
                                        <n>
                                          <span t-esc="loc['tenancy_id']" />
                                        </n>
                                    </td>
                                    <td class="text-center">
                                        <n>
                                                    <span t-esc="loc['tenancy_rent']" />
                                        </n>
                                    </td>
                                    <td class="text-center">
                                        <n>
                                                    <span t-esc="loc['state']" />
                                        </n>
                                    </td>
                                    <td class="text-center">
                                        <n>
                                                    <span t-esc="loc['close_date']" />
                                        </n>
                                    </td>
                                   
                                    <td class="text-center">
                                        <t t-if="loc['legal'] == True">
                                            <span
                                                style="font-size: 15px; margin-right: 5px;">
                                                Legal</span>
                                        </t>
                                        <t t-if="loc['legal_case'] == True">
                                            <span style="font-size: 15px;">, Legal Case</span>
                                        </t>
                                    </td>

                                    <td class="text-center">
                                        <n>
                                            <span t-esc="loc['month_due']" />
                                        </n>
                                    </td>

                                            <td style="width:50%;" class="text-center">
                                        <n>
                                            <span t-esc="loc['months_string']" />
                                        </n>
                                    </td>
                                    

                                    <td class="text-center">
                                        <n>
                                        <span t-esc="loc['initial_balance']" />
                                        </n>
                                    </td>
                                            <!-- <td class="text-center">
                                        <n>
                                                    <span t-esc="loc['balance']" />
                                        </n>
                                    </td> -->
                                    <td class="text-center">
                                        <n>
                                            <span t-esc="loc['debit']" />
                                        </n>
                                    </td>
                                    <td class="text-center">
                                        <n>
                                            <span t-esc="loc['credit']" />
                                        </n>
                                    </td>
                                    <td class="text-center">
                                        <n>
                                            <span t-esc="loc['total_balance']" />
                                        </n>
                                    </td>
                                </tr>
                                </t>

                            </t>
                                <tr style="background-color:#f0f0f0;">
                                    <td colspan="12" class="text-right">
                                        <strong>Totals:</strong>
                                    </td>
                                    <td class="text-center">
                                        <span t-esc="initial_total" />
                                    </td>
                                    <td class="text-center">
                                        <span t-esc="balance_total" />
                                    </td>
                                    <td class="text-center">
                                        <span t-esc="total_balance_total" />
                                    </td>
                                </tr>

                                <tr style="background-color:#f0f0f0;">
                                    <td colspan="14" class="text-right">
                                        <strong>Balance Accurate:</strong>
                                    </td>
                                    <td class="text-center">
                                        <span t-esc="balance_accurate" />
                                    </td>
                                    
                                </tr>

                                <tr style="background-color:#f0f0f0;">
                                    <td colspan="14" class="text-right">
                                        <strong>Balance Advanced:</strong>
                                    </td>
                                    <td class="text-center">
                                        <span t-esc="balance_advanced" />
                                    </td>

                                </tr>

                            </t>
                        </tbody>
                    </table>
                </t>
            </t>
        </t>
    </template>

    <record id="paper_format_payment_receipt" model="report.paperformat">
        <field name="name">Payment Receipt Format</field>
        <field name="default" eval="True" />
        <field name="format">custom</field>
        <field name="page_width">120</field>
        <field name="page_height">200</field>
        <field name="orientation">Landscape</field>
        <field name="margin_top">35</field>
        <field name="margin_bottom">5</field>
        <field name="margin_left">5</field>
        <field name="margin_right">5</field>
        <field name="header_line" eval="False" />
        <field name="header_spacing">30</field>
    </record>

    <record id="new_paper_format_custom_landscape" model="report.paperformat">
        <field name="name">My Report (custom) </field>
        <field name="default" eval="True" />
        <field name="format">A4</field>
        <field name="orientation">Landscape</field>
        <field name="margin_top">35</field>
        <field name="margin_bottom">25</field>
        <field name="margin_left">2</field>
        <field name="margin_right">2</field>
        <field name="header_line" eval="False" />
        <field name="header_spacing">20</field>
        <field name="dpi">90</field>
    </record>

    <record id="report_net_balance_tenants_id" model="ir.actions.report">
        <field name="name">Net Balance Tenants</field>
        <field name="model">net.balance.tenants.wiz</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">mm_property_inherit_new.tem_net_balance_ten_id</field>
        <field name="report_file">mm_property_inherit_new.tem_net_balance_ten_id</field>
        <field name="print_report_name">'Net Balance Tenants'</field>
        <field name="binding_model_id" eval="False" />
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="mm_property_inherit_new.new_paper_format_custom_landscape" />

    </record>

   




</odoo>